<!DOCTYPE html>
<html>
<%
var th = ['','Thousand','Million', 'Billion','Trillion'];
var dg = ['Zero','One','Two','Three','Four', 'Five','Six','Seven','Eight','Nine']; 
var tn = ['Ten','Eleven','Twelve','Thirteen', 'Fourteen','Fifteen','Sixteen', 'Seventeen','Eighteen','Nineteen'];
var tw = ['Twenty','Thirty','Forty','Fifty', 'Sixty','Seventy','Eighty','Ninety']; 


function toWords(s)
{  
    s = s.toString(); 
    s = s.replace(/[\, ]/g,''); 
    if (s != parseFloat(s)) return 'not a number'; 
    var x = s.indexOf('.'); 
    if (x == -1) x = s.length; 
    if (x > 15) return 'too big'; 
    var n = s.split(''); 
    var str = ''; 
    var sk = 0; 
    for (var i=0; i < x; i++) 
    {
        if ((x-i)%3==2) 
        {
            if (n[i] == '1') 
            {
                str += tn[Number(n[i+1])] + ' '; 
                i++; 
                sk=1;
            }
            else if (n[i]!=0) 
            {
                str += tw[n[i]-2] + ' ';
                sk=1;
            }
        }
        else if (n[i]!=0) 
        {
            str += dg[n[i]] +' '; 
            if ((x-i)%3==0) str += 'hundred ';
            sk=1;
        }


        if ((x-i)%3==1)
        {
            if (sk) str += th[(x-i-1)/3] + ' ';
            sk=0;
        }
    }
    if (x != s.length)
    {
        var y = s.length; 
        str += 'point '; 
        for (var i=x+1; i<y; i++) str += dg[n[i]] +' ';
    }
    return str.replace(/\s+/g,' ');
}
%>
<head>
    <style>
        .tdata,
        th,
        td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        
        h2 {
            text-align: center;
        }
        
        .table-data {
            border: 1px solid transparent;
            border-right: 1px solid;
            text-align: right;
        }
        .noborder{
            border:none;
            font-size:10px;
        }
.size{
    font-size:10px;
}
    </style>
</head>

<body>
    <div style="width: 600px; margin: 0 auto;">
        <div style="width:160px;">
            <address class="size"><%=assignment.company.address%><%=assignment.company.city.name%>,<%=assignment.company.city.district.state.name%>. Phone #: <%=assignment.company.phone%> FAX #: <%=assignment.company.fax%>  <%=assignment.company.email%> www.absolutesurveyors.co.in
            </address>
        </div>
    </div>
    <div style="width: 600px; margin: 0 auto;">
        <div style="width:200px;display:inline-block;vertical-align:middle;margin-left:350px;margin-top:-92px;">
            <img src="http://absolute.wohlig.co.in/api/upload/readFile?file=589c558c1d8a3a0fc6eb4c6e.png" style="width:200px;">
        </div>
    </div>
   <h2>Invoice</h2>
   <div class="clearfix" style="width:600px;margin:0 auto;padding-bottom:20px;" >
 <div style="width:200px;text-align:left;display:inline-block;vertical-align:middle;">
            <h4 class="size"><%=assignment.insurer.shortName%></h4>
            <address class="size"><%=assignment.insurer.name%> Branch Office 4th Floor, A Block,My Home Tycoon, Kundanbagh, Begumpet, Hyderabad
                500016, Andhra Pradesh, India</address>
        </div>
        <div style="width:200px;display:inline-block;vertical-align:middle;margin-left:100px;">
            <div class="size">
                <span style="padding:0 5px;" >Invoice No</span><span style="padding:0 12px;"><%= data.invoiceNumber%></span></div>
            <div class="size"> <span style="padding:0 5px;">Invoice Date</span><span style="padding:0 3px;"><%= moment(new Date(data.createdAt)).format("L")%></span></div>
        </div>
        </div>
            <div style="clear:both;"></div>

   <table  class="noborder size" style="width: 600px; margin: 0 auto;">
       <tr>
           <td class="noborder ">Appointed By</td>
           <td class="noborder">TAG BO Kolkata</td>
             <td class="noborder">COL</td>
              <td class="noborder">Theft</td>
       </tr>
       <tr>
           <td class="noborder">Insurer</td>
            <td class="noborder"><%=assignment.insurer.name%></td>
            <td class="noborder">NOL</td>
            <td class="noborder">Stolen</td>
       </tr>
       <tr>
           <td class="noborder">Insured</td>
            <td class="noborder"><%=assignment.insured.name%></td>
            <td class="noborder">Classification</td>
            <td class="noborder">Goods Vehicles</td>
       </tr>
       <tr>
           <td class="noborder">Policy Type</td>
            <td class="noborder"><%=assignment.policyType.name%></td>
            <td class="noborder">Product</td>
            <td class="noborder">Refuse/Garbage Collection</td>
       </tr>
       <tr>
           <td class="noborder">Policy Number</td>
            <td class="noborder">TAG BO Hyderabad</td>
            <td class="noborder">NOL</td>
            <td class="noborder">Stolen</td>
       </tr>
   </table>
    </div>
    
    <div style="margin: 0 50px;padding-top:30px;">
        <div style="margine-top:20px;">
        <table class="tdata" style="width: 100%">
            <tr>
            <th class="size">Sr #</th>
            <th class="size">Description</th>
            <th class="size">Quality</th>
            <th class="size">Unit</th>
            <th class="size">Rate</th>
            <th class="size">Amount</th>
        </tr>
            <% for(var i=0; i<data.invoiceList.length; i++) {%>
        <tr>
            <td class="size"><%=i+1%></td>
            <td class="size"><%=data.invoiceList[i].name%></td>
            <td class="size"><%=data.invoiceList[i].quantity%></td>
            <td class="size"><%=data.invoiceList[i].unit%></td>
            <td class="size"><%=data.invoiceList[i].rate%></td>
            <td class="size"><%=data.invoiceList[i].amount%></td>
            
        </tr>
        <%}%>
        <tr>
            <td colspan="5" class="table-data size">Sub Total</td>
            <td class="size"><%=data.subTotal%></td>
        </tr>
         <% for(var i=0; i<data.tax.length; i++) {%>
        <tr>
            <td colspan="5" class="table-data size"><%=data.tax[i].name%> @ <%=data.tax[i].percent%>%</td>
            <td class="size"><%=data.tax[i].amount%></td>
        </tr>
        <%}%>
        <tr>
            <td colspan="5" class="table-data size">Rounding Off </td>
            <td class="size">-<%=data.roundOff%></td>
        </tr>
        <tr>
            <td colspan="5" class="table-data size">Grand Total</td>
            <td class="size"><%=data.grandTotal%></td>
        
        </tr>
        </table>
    </div>
    </div>
    <div style="width:600px; margin: 0 auto;padding-top:30px;">
         <h5 class="size">INR <%=toWords(data.grandTotal)%> </h5>
        <div style="width:200px;text-align:left;display:inline-block;vertical-align:middle;">
           
            <address class="size">E. and O.E. Subjected to Ahmedabad Jurisdiction Service 
                Tax No: AAGCA3986L ST001(Insurance Auxiliary Services) 
                PAN No: AAGCA3986L. CIN: U93000GJ2007 PTC051 168</address>
        </div>
        <h5 class="size" style="margin-top:-122px; margin-left:266px;">For,Absolute Insurance Surveyors & Loss Assessors Pvt Ltd</h5>
        <p class="size" style="margin-left:460px;margin-top:90px;"> Authorized Signatory</p>
        </div>
</body>

</html>
</body>

</html>